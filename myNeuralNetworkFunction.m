function [Y,Xf,Af] = myNeuralNetworkFunction(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 14-Feb-2022 08:43:32.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx12 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx2 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0.0137582878171077;0.000358832708853154;2.76197315362095e-05;0.00490799615455971;1.83654729109273e-05;0.0233298152203021;0.661266568483063;0.00215054789943471;0.00771218743820363;0.00121767366345819;0.0237593561130393;0.00671208060861047];
x1_step1.gain = [2.02790043788891;18.1037251917373;40.5426867047627;2.99390511496604;209.493141518903;2.75267500772711;5.90434782608696;19.1411888696156;5.56433105037243;24.3813197742379;2.04867520372526;2.91986510244527];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.9726706808632161749;-1.8078123508875389991;1.6732651788475707555;1.7621386349514145397;1.7040185489062855684;-1.7378962508136683862;-1.6997104630889410259;1.4877963303318002541;-1.4633152946334397893;1.2887820762381514417;-1.1092768923422779981;1.0772246778090308617;-1.256800698432060992;-1.1155287356405929611;-1.1237540153871434789;0.99155894733005311981;0.8810483648554540137;0.81342632896793609643;-0.74811144227405868001;-0.62915858880266173347;-0.91020016759189481537;0.23918527040498507863;-0.55515835313777872617;-0.30635930353765949974;0.53687861843508921655;0.26187443530449039386;-0.37993782943029186239;-0.032394990788250276059;-0.10279622738846737329;0.0052918802290852513109;0.14100175516216889582;-0.27980057036050459685;0.086598538854173720547;-0.59682338270595192142;0.27819794670361874811;-0.2173413305141166374;-0.40618561914968154269;-0.70407150106772897757;0.49943555918653359527;-0.70420981008497463005;0.79534248401043705634;0.78277239559823086346;-0.97483171497561316166;0.93382019761740542307;-1.0575160891376274019;-1.1159770111173581419;1.0919231664537876192;1.2855964442652896285;1.3129478740497679823;1.290991588378154642;1.3437818643247334549;-1.2347912128746729721;-1.9690326088931413562;1.5734173686936621106;-1.8005622972555745953;1.7265579337262653148;1.7745425788392359401;1.8687063918581288124;1.9549916689728648045;-1.9550729574184801951];
IW1_1 = [0.27277560548869417278 0.41356224219181320079 -0.62769623213132652584 0.67112848211208309124 0.21944120039724307469 -0.51426703391576378266 -0.87312642169056631225 0.5193814209726981268 0.30064576425490124878 -0.60550163382405886026 0.70735448820198831843 0.67418141044657475813;0.80738698053976931668 -0.012714160281535241692 -0.41687668188367615896 -0.11925232873804658684 0.42466997536337225405 -0.81086429922671188208 0.83441616627627002156 -0.89260707697501784352 -0.63850054572331649272 0.35394511763842423369 0.50078151774158963239 -0.59593965231155654472;-0.53367699373674271079 0.02380780726173200787 -0.70689566810801884866 0.58238320558891076839 0.83750380416093472835 0.63315783476092302173 0.37526196622464086383 -0.014613367894302807526 0.95901043234512861613 0.0096737447870585240028 1.1090731303059990775 -0.055293010820213525647;-0.94340766630985528618 -0.044852866331833635138 -0.79430958050050337604 0.39493860682375314664 -0.60489430803831578665 -0.70167963309308345465 -0.23180037132173497705 0.20841924318886811962 0.0012114653328829535182 -0.36358421256605072402 -0.97104114686997489159 0.37066514797762806221;-0.24120676385384171025 -0.12902642156849444821 -0.73663574115527619135 0.56147292479956978362 -0.68076605687894009566 0.76680974558788239648 0.63280552060950956417 -0.5144654285880212452 0.66512370529977704603 -0.44933614146204586826 -0.6276307700903915876 0.43759794629170578606;0.49623789180233968121 -0.56712052672052493119 -0.54137362134297506433 -0.3713368868647346499 0.71902183846015677027 0.49693804833363375284 0.27604051735859830297 0.5706315921279004888 0.4414296329227960225 -0.048568783515432589759 0.9163279222143319025 -0.62809987682809642617;0.39124068183026838863 -0.35707733201798863565 0.75399681513677996314 0.73055559309314155314 -0.07105312664033194836 0.72063301561831738518 -0.72584598494429575233 -0.53661921508464471842 0.13162870197232373615 -0.57431692102254783272 -0.82090365485863525663 0.1641457460498811638;-0.099174146527362339043 0.77223961378876015971 0.83002477121008666483 -0.19234467981276753834 0.4826965179801001038 -0.10597197717396851513 -0.71068091123723675651 -0.60833409015938588738 0.26976332510910799867 -0.35002093223079988604 0.45771310560783556864 1.0755732415562941906;0.74762350305239266834 0.70494050898311766407 0.046165542654419924884 -0.72643065340490331483 0.8486644101776897875 -0.38583566680591602216 0.64982146000409779507 0.16627381049394771018 -0.29903025392633275636 -0.42729610188183142494 0.73857162383723951038 0.36668616423992661524;-0.04875962297638506554 0.83087247905513383905 0.93863647890196078016 0.66498571885609103482 -0.16494051549132301981 0.21731107258528298276 -0.16537165819093860297 0.38408576185871068365 0.030690779673333980215 1.1818252003984464071 -1.3736532699741261787 -1.0580610478228738014;-0.021626219608449844672 0.1093685146235158917 -0.64609124731304812261 0.67155810771473067877 -0.54316158897778143988 0.68915515238435109957 -0.31692631030391121838 0.38662945283768901383 0.63924270577644437541 0.32836171007921788334 0.86947340645684889626 -0.92757863472871049382;-0.73486462063840241044 0.52328785756026152676 -0.062627328168472232162 -0.66487336555443010688 0.26038840059317991393 0.82981328903261553087 -0.229140948627579083 -0.66399686500177546034 -0.5329886226834327223 -0.31608041934763475567 -1.1324334609137263197 0.0027232680028181849644;-0.28983552982790428132 -1.2083815456766022756 -0.36768658753404359629 0.090185352372625579576 0.10733545099724658978 0.99949986394034029402 0.55619718017846841995 1.1941406478532301527 -0.52052144735315353241 0.029780265517354347071 -0.12812746792284607222 0.01228801806397710264;0.21499148818746538492 0.25136716103854089832 0.5559551458061866569 0.71297482681240276214 0.39426348407893696546 0.9400333001572425129 -0.93330779861669066477 -0.31159690484702540214 -0.3959924349819353151 -0.55525113194395625538 -0.70216226633247180722 -0.022213080384078365964;0.44147384603481409915 -0.32966035832781598325 0.92024078582008983496 -0.63083356738481399795 0.26803735665198136218 -0.026179786003027543523 0.31804037191559392239 -0.92595744367280463649 0.62776400472152626975 -0.2655656831792760908 0.64155916971857451792 -0.65667213838805649218;-0.52877016343871297011 -0.81148369264197073303 -0.52679865685187043933 -0.84670911679579052844 -0.62277987331245010516 -0.017425702054817662073 0.28795614740565916856 -0.49024968325351098164 -0.73333511199778711465 -0.43239269619402836975 0.66029012382994545227 -0.23728819167185924432;-0.36557353308067330744 -0.86033528670308490049 0.46052723942713719163 -0.093350221999413271479 -0.11617666868449942619 -0.71524434100727907193 0.5570752214826920623 0.79675365270751918878 -0.5499796403748488105 0.28509624632247648757 0.60193785564665258647 0.75808672009049771212;-0.40632455553101953782 0.96614764167084588031 0.033938661848972026536 -0.80745475317263248893 -0.28427672332236686437 -0.083805956771525996762 -0.29013711926376378747 0.82916923166863665262 -0.44276441738626232114 0.035903106553186805994 0.89549792631849245428 0.54445423915295776407;0.19674769512214207445 0.014989999280418936714 0.50562250828592403273 0.93049317587682045527 -0.87678406695356581046 0.17801893582670014204 -0.7991245835898976857 0.15707442874038302083 -0.31977865850687736682 -0.89385343296586428075 0.56823650626883226433 -0.19321868208095305253;0.065844515429594283051 -0.68721104447141911908 0.56530421848022727183 0.68393303900435276077 -0.52287777394154244526 -0.72178818105088526913 0.66988288893461012119 0.072830884681664237457 0.33298977329553541837 -0.82659128350867083768 0.5532700985772419644 0.64138808312992068306;-0.041955305598955730528 -0.049014284033126756523 -0.30715566514641168272 1.0782583313270328595 1.0107121713616953329 -0.090902254013280350819 0.085658580729877448201 -0.71580622864887655243 0.64505837436559065878 -0.65344859418146328256 -0.018770880015011710829 -0.46223400186643770482;-1.1073942725493262085 -0.2493067186704358007 0.85152841939839096774 1.1697546154210121117 0.83097449921959831709 -0.31824716669146596582 -0.25733918696560215134 -0.45302966611374545502 -0.84394788167263234957 -0.43295549956638607059 0.81877593951749616519 -0.29803783961651253431;-0.19822571977858027825 -0.9316807869457088831 -1.0610897693479808268 0.5633813222484120864 0.54185340325593978061 0.1696452124203829126 0.33995434587889233891 -0.13926048807562896314 -0.70204456058578368349 -0.7216690233559301948 0.99666837297969956833 1.273179732953220622;0.41309323239278322726 0.19631450946576017857 0.016603408967692516451 0.32180667665523654541 -0.84016193807669015126 -0.080721242395173767314 0.63425099263885753587 0.60279742196267283028 -1.0757956010420246518 0.22850401763256114607 -0.47117271657525217066 -0.87953320239392629443;-0.42097739417819485253 -0.45827346730110124495 0.88261763104080925846 -0.43632126756816208557 0.016928807140090384314 -0.1635941969450746547 0.29060182400470102593 -0.28923519626223570533 -0.83733842241128331185 1.0413420134308888354 -0.37862532197061982142 -0.31402588981511897481;-0.19943717805483665573 -0.45290213010660596016 -0.54497576023990546012 -0.75545987970046246662 -0.74221129334373159292 -0.72858631335926460348 0.45085417878342837206 -0.32504758187204096931 -0.81499133215836960797 0.42952600341284263852 0.62766409841493941979 -0.38519451699896400942;0.50045443220894791914 -0.52890695277689936393 -0.018627264530217440414 0.00060509679050535633213 0.50407462673678837817 -0.61258204560264939431 0.26110914724641015594 -0.58630014214185000032 -0.087586886394953974988 0.3894813334812916028 -1.1228726165443883023 -0.99546659988995844781;-0.75799833158740104189 -0.32220697124738928441 -0.37822595072429882057 0.23575185102606374676 0.95596861254716536394 -0.59181599234552417776 -0.2185468385146177861 -0.20864614201674330785 -0.46266802042733640166 0.67850136890138046386 0.90536306453978754316 -0.51062739498737907962;0.88216807753823167637 -0.90855505464336661081 0.13895017016450897374 0.09788357317231588528 0.8088385466101312149 0.41435937495397823227 0.36244980694920136965 -0.15139118688582503536 0.81850653146070184718 0.47989205074896651437 -0.58046856856859885276 -0.16730340136709712096;-0.7103416915584203073 -0.30545986115791623483 0.6696955667489843389 0.59134602109095213418 -0.68054578990556446882 0.35925264482084184881 0.84137964939143750076 -0.52172696483119718192 0.48525667271869793451 0.19370078281589545033 0.74917529378091740622 -0.33373963655432042907;0.6756850540557461926 0.80640439415835962755 -0.20708171007040712674 0.15830238832724127795 -0.49575366136749793311 -1.1054944466862410835 0.57758034628932808374 -0.075622102486602865712 0.004560985947174391042 1.2045340200150775889 -1.3607721146226334774 0.34187010861943911699;-0.84191229866119710046 0.12303880046436869999 0.32702971924527424186 0.95430338301200146045 0.63186090058167287964 -0.65555074609732510993 0.39306674497242066746 0.44715330170226724738 -0.65931049038547329122 -0.14676402860949469553 -0.52368019901605622479 -0.30057490831218425242;-0.91905710284020181167 -1.5093504231203769272 0.63789013933423910352 0.041147398616052495435 -0.3525155866056554621 -0.73850529531477104861 -0.49190007690317605338 0.44585859175871089821 -0.072660757860191979574 -0.17783388034847932846 0.51125909393669455305 0.90924857580926754519;-0.77057804141546182297 -0.034147015860391601028 0.8749689716639721393 1.2645948913853231055 0.36667736300416914341 0.65837421672691143204 0.21813120782019498889 -0.10090657777972472653 0.42692752495683983227 -0.78340617421351776972 -0.54178893770551239673 -0.11538461081487366711;0.82458393775585037133 -0.030606632982718869757 0.58875904480384844142 -0.6798369698014403717 0.71159105564220193063 0.082796144661221954264 -0.52491950369847861779 0.81263917867615664825 0.1731846387429959444 -0.38851455066323092868 0.51107251835411560137 -0.65981009238457666299;-0.91241129021415945388 -0.057395644975375040286 0.55178862065964151551 0.39720088236928491332 0.71714392254071179789 0.5356975756013976353 -0.033611991418704030565 -0.5815294930559086195 -0.36825798577050272709 -1.1768425789765106781 0.64225689374269945286 -0.012219690745233612733;-0.14144403591944793019 0.37356355093800730494 -0.65936406304084471675 0.82192087646210787444 -0.84029362623792369646 -0.55982974920210060166 0.45682632586326687996 0.64327992049018156706 -0.56925993684715403553 -0.34240221601054293687 -0.037024396767816304676 0.6990517432915775986;-0.18366584081648715254 -0.76477507471447936371 0.60817745641133202916 -0.55518419154745923816 -0.28199638652279257478 -0.67891154375528395271 -0.32627582676270355799 -0.52614235308148238346 0.59632550386565308376 -0.92826543867078281647 -0.8756375622485896848 -0.29014846153883505631;0.45871454755001989101 0.7213541768271667376 0.42697563368796465078 0.52018664846836903948 0.017823029851375443017 -0.68982049044122284442 -0.92934815866829023623 0.61465044864170204075 -0.33663724831224905998 -0.13784163330116419588 -0.66584563053373035935 0.74067155137767437534;-1.7355252516604071644 -0.4463794594087173162 0.67600830472860196085 0.6025798911022127724 0.59348721069463494793 0.24476382343284688869 -0.86588949825671834848 -0.20873393521252242566 -0.12448160428008779588 -1.2552664420295496228 0.31704501968606735307 0.029525355303134399182;0.50230448338745870007 0.65883343575817987503 0.26568863647987206456 0.27170818078999059431 0.70511263236375243402 -0.39642412202199273086 -0.73154733074087563427 0.40464770770389252297 0.5660513664765499664 0.55394409609750283607 0.89734323393728299134 -0.33881814401204124465;0.5366956000527138837 0.89251959303369732268 -0.40176671436608585308 0.43742077240085230905 0.66923707436261881121 0.49667100144657616578 0.59264219963154918247 -0.84964336551713293133 -0.09292809590233061523 1.0065322315058529146 0.16110730746335477637 -1.1046943116967420373;-1.0186657984268743249 -0.85193022962433029299 -0.72102070234013404537 0.54054260661374775587 -0.33620153299852517659 -0.46963816987059325836 -0.61682701875590895124 0.82300358976109866394 -0.29387329252554278414 -0.76961170189381911122 0.026023685188482692521 0.93757119823183776575;-0.14144541839564733765 -1.0415465901143057259 -0.87071629292866525862 0.026612842486461132929 0.87718840781690832209 0.020020936404371428297 -0.1518250326981605558 0.46868533881446872158 0.65317511717736120858 0.52519533889167580032 0.18650671227775467154 -0.61220194168321484529;-0.55181770534169827247 -1.3047850478167724031 -0.42012784029176025724 0.61304894529772269163 0.68114882007984822732 -0.6071609389296878101 -0.77293320793088238219 0.034309437595101494045 -0.86633770161226131279 -0.77805663096073351959 0.86976912095894709509 -0.0098556913787754135692;-0.0054604931255038142296 -0.59868260960438368645 0.72758588880956653888 0.079783519681475789653 -0.020287080447353739859 -0.80054158846160616836 0.68624862129933317245 -0.069059021084533198098 0.56202104180950473999 -0.75354555836107017797 -0.63343244324999448125 -0.437120518796960289;0.35909351612794943032 0.085503013574885433634 0.90874247416359688057 1.0803119729713219765 0.61405213549400805562 -0.050530001145893267689 -0.27081303744180085236 -0.41520734724021046702 0.85236549288906671151 0.34565997735910852784 0.051780738643294597912 -0.57147234371761390648;0.31831222835685590855 -0.51641940278900178019 -0.15277566039792850328 -1.0202177955323492586 0.089014750432297673477 0.37981486322309720993 -0.54728771476229021165 -0.18572957112859095341 -0.011205639701979500447 1.2350856848714864 0.67248294751820814064 -0.29673162715390521971;0.68495339686704281856 -0.49686891186852599755 0.88913241922476349277 0.48005854435732886465 0.76905346397997753627 0.20079992222861561824 0.64207460767500357246 -0.42939688132525144493 -0.13445958604389021684 0.6835566660154958063 -0.039788872296871717615 0.60934505529231652865;0.75607772439027842726 0.10888149675056031651 -0.76033981500404412834 -0.52004138198619920264 -0.17052349465585597832 -0.49060704600958227051 -0.7989432657336431598 -0.70717789222938820526 -0.56799003535876801951 0.22089466844730656914 -0.42270156654635160365 0.69259250668035177156;0.57516832279844598563 0.89041609188655246321 0.66915043749442026932 0.62205424312998647274 0.75219261960523897681 0.20165289039659622938 -0.74396171592623383528 -0.15214756261643033741 0.81395226766160966303 -0.29692194127016774408 -0.34381863190973765976 0.11567333641072835571;-0.86621420863775233645 -1.6985310257467010064 -0.27071976223883431611 -0.32860135165426346271 0.80506551322241703961 0.40596148611586430066 0.17689483322110191588 0.44254557170817160339 0.87884092257047075059 -1.0599823506718237809 0.48687912407821815064 0.3656870397328896849;-1.3251875368745194006 -1.0913906115624587567 1.0547270918064286516 0.78054688364909008413 0.046437638567914607535 -0.18963057527858895313 0.32245192944618616959 -0.070645452720144275016 -0.050914921933775024454 -0.44049915095118713504 -0.23824372053863798748 -0.3388779258083329804;1.0957409137474687366 -0.75608562422377123546 0.88730140934459911239 -0.34219669337935132436 0.5663213492402515703 0.70292463412238681553 0.30761668113115941958 -0.24778784819406357576 -0.22222862635573739643 -0.31951072707403177509 -0.26953675398737420021 0.17914523241744420567;0.03678670158070805607 -0.51127398155494852006 -0.40250191012371144827 -0.017506742545298530772 0.91072495664023600526 -0.51397615218858005992 0.013069760929140574954 -0.52092940133217180421 -0.44520314924634118992 0.91162060246322862422 -0.2913088843373910497 0.87877188094775016136;0.99398043308912575888 0.88124968551544657913 -0.19144027553722897661 0.36026250007984045309 0.85945793373838341722 -0.55889325454118354841 0.36885152420066996681 -0.1485330145922084677 0.98166394226010622592 -0.73661196623747871026 -0.2829396572850874092 -0.23030860081164791775;0.52203165433281928376 -0.095488579676185028622 -0.77294939144163388178 0.78431944532808461901 -0.73238648345407431073 0.16478941821492854025 0.7270693978644479083 -0.35627547232977119229 -0.85538607338471639441 0.33534224091210290686 0.53894174732402810868 -0.1764709398471279167;0.54561239152857521351 -0.008638484310809777314 -0.11460547981330632128 0.63111030839595061437 -0.88526316574386931801 0.6551038894461802542 -0.48205597067091465746 -0.85711434439467837354 -0.55502381485777385617 -0.29598733570359786471 -0.20812996413867981826 -0.7176205774289481365;0.27037678570037332326 0.2866292886911749882 -0.20509111900091384073 0.2112157847472354022 0.16213021532157464999 0.79523784074282422019 1.129321158234989575 0.9745940743278350693 -0.5179109239881725113 -0.52393963032445323158 -0.048244736927724081454 0.34824379772389568721;-0.33158242361195172654 0.54441312229388327815 -0.29157515294540498063 0.72762319421407051223 -0.78024883763587660201 0.14239895146288930605 -0.69208303854799979593 -0.47494591353535042799 -0.73692987010004318282 0.18001137904196123918 -0.64577115388710448762 0.7508005618141111448];

% Layer 2
b2 = [0.30951002836675112206;0.079065329117692650929];
LW2_1 = [0.22416497708850069426 -0.12145019627742316415 0.82292765052462446551 0.13650158026187134142 0.30789863009554779838 0.51537453377290209922 -0.23403192480610837678 0.028752493305376006227 -0.23162272526284616303 -1.144109653089105505 0.85682095298041394127 -0.26640546264302261692 1.3673088599574207969 0.17792973859326344233 -0.15104574760940636668 -0.61085864217760243999 0.52922633028875543104 0.19655540911515018143 0.60699791900926436394 1.2025327930432105905 0.0083590629394843761479 0.45314832734211579757 1.6638529687356575781 0.46008773411659970032 -0.38964979387289983004 1.0705408851798019487 -0.99118437865818043164 0.94491485727725843535 -0.13345492938600400645 -0.3502991717833491836 -1.4754824389498137904 0.17445406172996827388 1.4564059795843669054 0.50215349799565223154 -0.35010211421852427405 0.95386358482012623128 0.17565271872184101687 -0.85917501179078104023 0.80075394217705975208 0.43102086249675097829 0.65295866949504233201 -0.65290080659128091334 1.0892324215930277997 0.43379846667405430605 1.1643322873625188141 0.5911576901442506804 -0.94864026097476772392 -0.71665990297698978218 -0.10507222027737990466 0.39300792527753714012 -0.8811776121159273778 1.4743380414288707048 0.89548279889551041233 -0.12431658162911195242 -0.75618056839591296647 -0.19294342017082041774 0.34317806766702585453 0.38318782604224138622 -0.68454812453780000681 0.80649052630133255537;-0.011064157874209258614 0.60854389663925601006 -0.051077253689517695956 0.74693374376256582714 0.18063602750682636322 0.61183847289470627562 0.41760252630525235285 -0.25473274468032197637 0.47616971456322004785 1.5558191548593141018 -0.32645147252037715058 0.93616143194533740779 -0.19952471012935582562 0.70970958001602968412 0.70845935474406063204 -0.10927847364444051581 -0.60107111970940185763 -0.36833539290404854194 0.3382461096010850321 0.63682823340330352302 -0.69544198075523755431 -1.2638085941807681856 -0.63181820557109724668 0.60698069974158308515 -0.48728127137252857937 0.10532353267627404814 0.099924820719317658524 -0.10187712528009537638 0.10571210715070859798 -0.78374865969060913962 1.1047245619233450054 -0.22448794998119445121 -1.0347589628288298425 -0.62505024580364310083 -0.42302876526751198583 -0.26417544936658349242 -0.53324200917420128132 0.35235649175719080395 -0.6370316509161682017 -2.0365178907198342451 -0.013667121177618446817 1.4070608074625157169 -1.1666614339395784405 -0.87768023180655330151 -1.1717039581042094643 0.34941241736981237809 0.39721664582248278341 -0.15692941764175505348 0.92020896438183019672 0.50032065912948953113 0.18317596683534723145 -1.4572096872088340369 -1.4646481842538618956 0.37204878536560020974 0.57691898991078560677 1.2646998486076572732 -0.27032070774658822909 -0.10953376120308580544 0.14670489977062295406 0.046785381975016485101];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = softmax_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n,~)
if isa(n,'gpuArray')
    a = iSoftmaxApplyGPU(n);
else
    a = iSoftmaxApplyCPU(n);
end
end
function a = iSoftmaxApplyCPU(n)
nmax = max(n,[],1);
n = bsxfun(@minus,n,nmax);
numerator = exp(n);
denominator = sum(numerator,1);
denominator(denominator == 0) = 1;
a = bsxfun(@rdivide,numerator,denominator);
end
function a = iSoftmaxApplyGPU(n)
nmax = max(n,[],1);
numerator = arrayfun(@iSoftmaxApplyGPUHelper1,n,nmax);
denominator = sum(numerator,1);
a = arrayfun(@iSoftmaxApplyGPUHelper2,numerator,denominator);
end
function numerator = iSoftmaxApplyGPUHelper1(n,nmax)
numerator = exp(n - nmax);
end
function a = iSoftmaxApplyGPUHelper2(numerator,denominator)
if (denominator == 0)
    a = numerator;
else
    a = numerator ./ denominator;
end
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end
